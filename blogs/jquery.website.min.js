!function(e, t) {
    "function" == typeof define && define.amd ? define("sifter", t) : "object" == typeof exports ? module.exports = t() : e.Sifter = t()
}(this, function() {
    var e = function(e, t) {
        this.items = e,
        this.settings = t || {
            diacritics: !0
        }
    };
    e.prototype.tokenize = function(e) {
        if (!(e = a(String(e || "").toLowerCase())) || !e.length)
            return [];
        var t, i, n, o, s = [], r = e.split(/ +/);
        for (t = 0,
        i = r.length; t < i; t++) {
            if (n = l(r[t]),
            this.settings.diacritics)
                for (o in c)
                    c.hasOwnProperty(o) && (n = n.replace(new RegExp(o,"g"), c[o]));
            s.push({
                string: r[t],
                regex: new RegExp(n,"i")
            })
        }
        return s
    }
    ,
    e.prototype.iterator = function(e, t) {
        (r(e) ? Array.prototype.forEach || function(e) {
            for (var t = 0, i = this.length; t < i; t++)
                e(this[t], t, this)
        }
        : function(e) {
            for (var t in this)
                this.hasOwnProperty(t) && e(this[t], t, this)
        }
        ).apply(e, [t])
    }
    ,
    e.prototype.getScoreFunction = function(e, t) {
        var o, s, r, a;
        e = this.prepareSearch(e, t),
        s = e.tokens,
        o = e.options.fields,
        r = s.length,
        a = e.options.nesting;
        var l, c = function(e, t) {
            var i, n;
            return e ? -1 === (n = (e = String(e || "")).search(t.regex)) ? 0 : (i = t.string.length / e.length,
            0 === n && (i += .5),
            i) : 0
        }, p = (l = o.length) ? 1 === l ? function(e, t) {
            return c(f(t, o[0], a), e)
        }
        : function(e, t) {
            for (var i = 0, n = 0; i < l; i++)
                n += c(f(t, o[i], a), e);
            return n / l
        }
        : function() {
            return 0
        }
        ;
        return r ? 1 === r ? function(e) {
            return p(s[0], e)
        }
        : "and" === e.options.conjunction ? function(e) {
            for (var t, i = 0, n = 0; i < r; i++) {
                if ((t = p(s[i], e)) <= 0)
                    return 0;
                n += t
            }
            return n / r
        }
        : function(e) {
            for (var t = 0, i = 0; t < r; t++)
                i += p(s[t], e);
            return i / r
        }
        : function() {
            return 0
        }
    }
    ,
    e.prototype.getSortFunction = function(e, i) {
        var t, n, o, s, r, a, l, c, p, u, d;
        if (d = !(e = (o = this).prepareSearch(e, i)).query && i.sort_empty || i.sort,
        p = function(e, t) {
            return "$score" === e ? t.score : f(o.items[t.id], e, i.nesting)
        }
        ,
        r = [],
        d)
            for (t = 0,
            n = d.length; t < n; t++)
                (e.query || "$score" !== d[t].field) && r.push(d[t]);
        if (e.query) {
            for (u = !0,
            t = 0,
            n = r.length; t < n; t++)
                if ("$score" === r[t].field) {
                    u = !1;
                    break
                }
            u && r.unshift({
                field: "$score",
                direction: "desc"
            })
        } else
            for (t = 0,
            n = r.length; t < n; t++)
                if ("$score" === r[t].field) {
                    r.splice(t, 1);
                    break
                }
        for (c = [],
        t = 0,
        n = r.length; t < n; t++)
            c.push("desc" === r[t].direction ? -1 : 1);
        return (a = r.length) ? 1 === a ? (s = r[0].field,
        l = c[0],
        function(e, t) {
            return l * h(p(s, e), p(s, t))
        }
        ) : function(e, t) {
            var i, n, o;
            for (i = 0; i < a; i++)
                if (o = r[i].field,
                n = c[i] * h(p(o, e), p(o, t)))
                    return n;
            return 0
        }
        : null
    }
    ,
    e.prototype.prepareSearch = function(e, t) {
        if ("object" == typeof e)
            return e;
        var i = (t = s({}, t)).fields
          , n = t.sort
          , o = t.sort_empty;
        return i && !r(i) && (t.fields = [i]),
        n && !r(n) && (t.sort = [n]),
        o && !r(o) && (t.sort_empty = [o]),
        {
            options: t,
            query: String(e || "").toLowerCase(),
            tokens: this.tokenize(e),
            total: 0,
            items: []
        }
    }
    ,
    e.prototype.search = function(e, i) {
        var n, o, t, s, r = this;
        return o = this.prepareSearch(e, i),
        i = o.options,
        e = o.query,
        s = i.score || r.getScoreFunction(o),
        e.length ? r.iterator(r.items, function(e, t) {
            n = s(e),
            (!1 === i.filter || 0 < n) && o.items.push({
                score: n,
                id: t
            })
        }) : r.iterator(r.items, function(e, t) {
            o.items.push({
                score: 1,
                id: t
            })
        }),
        (t = r.getSortFunction(o, i)) && o.items.sort(t),
        o.total = o.items.length,
        "number" == typeof i.limit && (o.items = o.items.slice(0, i.limit)),
        o
    }
    ;
    var h = function(e, t) {
        return "number" == typeof e && "number" == typeof t || (e = i(String(e || "")),
        t = i(String(t || ""))),
        t < e ? 1 : e < t ? -1 : 0
    }
      , s = function(e, t) {
        var i, n, o, s;
        for (i = 1,
        n = arguments.length; i < n; i++)
            if (s = arguments[i])
                for (o in s)
                    s.hasOwnProperty(o) && (e[o] = s[o]);
        return e
    }
      , f = function(e, t, i) {
        if (e && t) {
            if (!i)
                return e[t];
            for (var n = t.split("."); n.length && (e = e[n.shift()]); )
                ;
            return e
        }
    }
      , a = function(e) {
        return (e + "").replace(/^\s+|\s+$|/g, "")
    }
      , l = function(e) {
        return (e + "").replace(/([.?*+^$[\]\\(){}|-])/g, "\\$1")
    }
      , r = Array.isArray || "undefined" != typeof $ && $.isArray || function(e) {
        return "[object Array]" === Object.prototype.toString.call(e)
    }
      , c = {
        a: "[aá¸€á¸Ä‚ÄƒÃ‚Ã¢ÇÇŽÈºâ±¥È¦È§áº áº¡Ã„Ã¤Ã€Ã ÃÃ¡Ä€ÄÃƒÃ£Ã…Ã¥Ä…Ä„ÃƒÄ…Ä„]",
        b: "[bâ¢Î²Î’Bà¸¿ðŒá›’]",
        c: "[cÄ†Ä‡ÄˆÄ‰ÄŒÄÄŠÄ‹CÌ„cÌ„Ã‡Ã§á¸ˆá¸‰È»È¼Æ‡ÆˆÉ•á´„ï¼£ï½ƒ]",
        d: "[dÄŽÄá¸Šá¸‹á¸á¸‘á¸Œá¸á¸’á¸“á¸Žá¸ÄÄ‘DÌ¦dÌ¦Æ‰É–ÆŠÉ—Æ‹ÆŒáµ­á¶á¶‘È¡á´…ï¼¤ï½„Ã°]",
        e: "[eÃ‰Ã©ÃˆÃ¨ÃŠÃªá¸˜á¸™ÄšÄ›Ä”Ä•áº¼áº½á¸šá¸›áººáº»Ä–Ä—Ã‹Ã«Ä’Ä“È¨È©Ä˜Ä™á¶’É†É‡È„È…áº¾áº¿á»€á»á»„á»…á»‚á»ƒá¸œá¸á¸–á¸—á¸”á¸•È†È‡áº¸áº¹á»†á»‡â±¸á´‡ï¼¥ï½…É˜ÇÆÆÎµ]",
        f: "[fÆ‘Æ’á¸žá¸Ÿ]",
        g: "[gÉ¢â‚²Ç¤Ç¥ÄœÄÄžÄŸÄ¢Ä£Æ“É Ä Ä¡]",
        h: "[hÄ¤Ä¥Ä¦Ä§á¸¨á¸©áº–áº–á¸¤á¸¥á¸¢á¸£É¦Ê°Ç¶Æ•]",
        i: "[iÃÃ­ÃŒÃ¬Ä¬Ä­ÃŽÃ®ÇÇÃÃ¯á¸®á¸¯Ä¨Ä©Ä®Ä¯ÄªÄ«á»ˆá»‰ÈˆÈ‰ÈŠÈ‹á»Šá»‹á¸¬á¸­Æ—É¨É¨Ì†áµ»á¶–Ä°iIÄ±Éªï¼©ï½‰]",
        j: "[jÈ·Ä´ÄµÉˆÉ‰ÊÉŸÊ²]",
        k: "[kÆ˜Æ™ê€êá¸°á¸±Ç¨Ç©á¸²á¸³á¸´á¸µÎºÏ°â‚­]",
        l: "[lÅÅ‚Ä½Ä¾Ä»Ä¼Ä¹Äºá¸¶á¸·á¸¸á¸¹á¸¼á¸½á¸ºá¸»Ä¿Å€È½Æšâ± â±¡â±¢É«É¬á¶…É­È´ÊŸï¼¬ï½Œ]",
        n: "[nÅƒÅ„Ç¸Ç¹Å‡ÅˆÃ‘Ã±á¹„á¹…Å…Å†á¹†á¹‡á¹Šá¹‹á¹ˆá¹‰NÌˆnÌˆÆÉ²È Æžáµ°á¶‡É³ÈµÉ´ï¼®ï½ŽÅŠÅ‹]",
        o: "[oÃ˜Ã¸Ã–Ã¶Ã“Ã³Ã’Ã²Ã”Ã´Ç‘Ç’ÅÅ‘ÅŽÅÈ®È¯á»Œá»ÆŸÉµÆ Æ¡á»Žá»ÅŒÅÃ•ÃµÇªÇ«ÈŒÈÕ•Ö…]",
        p: "[pá¹”á¹•á¹–á¹—â±£áµ½Æ¤Æ¥áµ±]",
        q: "[qê–ê—Ê ÉŠÉ‹ê˜ê™qÌƒ]",
        r: "[rÅ”Å•ÉŒÉÅ˜Å™Å–Å—á¹˜á¹™ÈÈ‘È’È“á¹šá¹›â±¤É½]",
        s: "[sÅšÅ›á¹ á¹¡á¹¢á¹£êž¨êž©ÅœÅÅ Å¡ÅžÅŸÈ˜È™SÌˆsÌˆ]",
        t: "[tÅ¤Å¥á¹ªá¹«Å¢Å£á¹¬á¹­Æ®ÊˆÈšÈ›á¹°á¹±á¹®á¹¯Æ¬Æ­]",
        u: "[uÅ¬Å­É„Ê‰á»¤á»¥ÃœÃ¼ÃšÃºÃ™Ã¹Ã›Ã»Ç“Ç”Å°Å±Å¬Å­Æ¯Æ°á»¦á»§ÅªÅ«Å¨Å©Å²Å³È”È•âˆª]",
        v: "[vá¹¼á¹½á¹¾á¹¿Æ²Ê‹êžêŸâ±±Ê‹]",
        w: "[wáº‚áºƒáº€áºÅ´Åµáº„áº…áº†áº‡áºˆáº‰]",
        x: "[xáºŒáºáºŠáº‹Ï‡]",
        y: "[yÃÃ½á»²á»³Å¶Å·Å¸Ã¿á»¸á»¹áºŽáºá»´á»µÉŽÉÆ³Æ´]",
        z: "[zÅ¹Åºáºáº‘Å½Å¾Å»Å¼áº’áº“áº”áº•ÆµÆ¶]"
    }
      , i = function() {
        var e, t, i, n, o = "", s = {};
        for (i in c)
            if (c.hasOwnProperty(i))
                for (o += n = c[i].substring(2, c[i].length - 1),
                e = 0,
                t = n.length; e < t; e++)
                    s[n.charAt(e)] = i;
        var r = new RegExp("[" + o + "]","g");
        return function(e) {
            return e.replace(r, function(e) {
                return s[e]
            }).toLowerCase()
        }
    }();
    return e
}),
function(e, t) {
    "function" == typeof define && define.amd ? define("microplugin", t) : "object" == typeof exports ? module.exports = t() : e.MicroPlugin = t()
}(this, function() {
    var e = {
        mixin: function(n) {
            n.plugins = {},
            n.prototype.initializePlugins = function(e) {
                var t, i, n, o = [];
                if (this.plugins = {
                    names: [],
                    settings: {},
                    requested: {},
                    loaded: {}
                },
                s.isArray(e))
                    for (t = 0,
                    i = e.length; t < i; t++)
                        "string" == typeof e[t] ? o.push(e[t]) : (this.plugins.settings[e[t].name] = e[t].options,
                        o.push(e[t].name));
                else if (e)
                    for (n in e)
                        e.hasOwnProperty(n) && (this.plugins.settings[n] = e[n],
                        o.push(n));
                for (; o.length; )
                    this.require(o.shift())
            }
            ,
            n.prototype.loadPlugin = function(e) {
                var t = this.plugins
                  , i = n.plugins[e];
                if (!n.plugins.hasOwnProperty(e))
                    throw new Error('Unable to find "' + e + '" plugin');
                t.requested[e] = !0,
                t.loaded[e] = i.fn.apply(this, [this.plugins.settings[e] || {}]),
                t.names.push(e)
            }
            ,
            n.prototype.require = function(e) {
                var t = this.plugins;
                if (!this.plugins.loaded.hasOwnProperty(e)) {
                    if (t.requested[e])
                        throw new Error('Plugin has circular dependency ("' + e + '")');
                    this.loadPlugin(e)
                }
                return t.loaded[e]
            }
            ,
            n.define = function(e, t) {
                n.plugins[e] = {
                    name: e,
                    fn: t
                }
            }
        }
    }
      , s = {
        isArray: Array.isArray || function(e) {
            return "[object Array]" === Object.prototype.toString.call(e)
        }
    };
    return e
}),
function(e, t) {
    "function" == typeof define && define.amd ? define("selectize", ["jquery", "sifter", "microplugin"], t) : "object" == typeof exports ? module.exports = t(require("jquery"), require("sifter"), require("microplugin")) : e.Selectize = t(e.jQuery, e.Sifter, e.MicroPlugin)
}(this, function(x, u, e) {
    "use strict";
    var S = function(e, t) {
        if ("string" != typeof t || t.length) {
            var l = "string" == typeof t ? new RegExp(t,"i") : t
              , c = function(e) {
                var t = 0;
                if (3 === e.nodeType) {
                    var i = e.data.search(l);
                    if (0 <= i && 0 < e.data.length) {
                        var n = e.data.match(l)
                          , o = document.createElement("span");
                        o.className = "highlight";
                        var s = e.splitText(i)
                          , r = (s.splitText(n[0].length),
                        s.cloneNode(!0));
                        o.appendChild(r),
                        s.parentNode.replaceChild(o, s),
                        t = 1
                    }
                } else if (1 === e.nodeType && e.childNodes && !/(script|style)/i.test(e.tagName))
                    for (var a = 0; a < e.childNodes.length; ++a)
                        a += c(e.childNodes[a]);
                return t
            };
            return e.each(function() {
                c(this)
            })
        }
    };
    x.fn.removeHighlight = function() {
        return this.find("span.highlight").each(function() {
            this.parentNode.firstChild.nodeName;
            var e = this.parentNode;
            e.replaceChild(this.firstChild, this),
            e.normalize()
        }).end()
    }
    ;
    var n = function() {};
    n.prototype = {
        on: function(e, t) {
            this._events = this._events || {},
            this._events[e] = this._events[e] || [],
            this._events[e].push(t)
        },
        off: function(e, t) {
            var i = arguments.length;
            return 0 === i ? delete this._events : 1 === i ? delete this._events[e] : (this._events = this._events || {},
            void (e in this._events != 0 && this._events[e].splice(this._events[e].indexOf(t), 1)))
        },
        trigger: function(e) {
            if (this._events = this._events || {},
            e in this._events != 0)
                for (var t = 0; t < this._events[e].length; t++)
                    this._events[e][t].apply(this, Array.prototype.slice.call(arguments, 1))
        }
    },
    n.mixin = function(e) {
        for (var t = ["on", "off", "trigger"], i = 0; i < t.length; i++)
            e.prototype[t[i]] = n.prototype[t[i]]
    }
    ;
    var O = /Mac/.test(navigator.userAgent)
      , C = O ? 91 : 17
      , $ = O ? 18 : 17
      , _ = !/android/i.test(window.navigator.userAgent) && !!document.createElement("input").validity
      , c = function(e) {
        return void 0 !== e
    }
      , k = function(e) {
        return null == e ? null : "boolean" == typeof e ? e ? "1" : "0" : e + ""
    }
      , a = function(e) {
        return (e + "").replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;")
    }
      , t = {
        before: function(e, t, i) {
            var n = e[t];
            e[t] = function() {
                return i.apply(e, arguments),
                n.apply(e, arguments)
            }
        },
        after: function(t, e, i) {
            var n = t[e];
            t[e] = function() {
                var e = n.apply(t, arguments);
                return i.apply(t, arguments),
                e
            }
        }
    }
      , i = function(t, i, e) {
        var n, o = t.trigger, s = {};
        for (n in t.trigger = function() {
            var e = arguments[0];
            return -1 === i.indexOf(e) ? o.apply(t, arguments) : void (s[e] = arguments)
        }
        ,
        e.apply(t, []),
        t.trigger = o,
        s)
            s.hasOwnProperty(n) && o.apply(t, s[n])
    }
      , d = function(e) {
        var t = {};
        if ("selectionStart"in e)
            t.start = e.selectionStart,
            t.length = e.selectionEnd - t.start;
        else if (document.selection) {
            e.focus();
            var i = document.selection.createRange()
              , n = document.selection.createRange().text.length;
            i.moveStart("character", -e.value.length),
            t.start = i.text.length - n,
            t.length = n
        }
        return t
    }
      , I = function(p) {
        var u = null
          , e = function(e, t) {
            var i, n, o, s, r, a, l, c;
            t = t || {},
            (e = e || window.event || {}).metaKey || e.altKey || (t.force || !1 !== p.data("grow")) && (i = p.val(),
            e.type && "keydown" === e.type.toLowerCase() && (o = 97 <= (n = e.keyCode) && n <= 122 || 65 <= n && n <= 90 || 48 <= n && n <= 57 || 32 === n,
            46 === n || 8 === n ? (c = d(p[0])).length ? i = i.substring(0, c.start) + i.substring(c.start + c.length) : 8 === n && c.start ? i = i.substring(0, c.start - 1) + i.substring(c.start + 1) : 46 === n && void 0 !== c.start && (i = i.substring(0, c.start) + i.substring(c.start + 1)) : o && (a = e.shiftKey,
            l = String.fromCharCode(e.keyCode),
            i += l = a ? l.toUpperCase() : l.toLowerCase())),
            s = p.attr("placeholder"),
            !i && s && (i = s),
            (r = function(e, t) {
                if (!e)
                    return 0;
                var i = x("<test>").css({
                    position: "absolute",
                    top: -99999,
                    left: -99999,
                    width: "auto",
                    padding: 0,
                    whiteSpace: "pre"
                }).text(e).appendTo("body");
                !function(e, t, i) {
                    var n, o, s = {};
                    if (i)
                        for (n = 0,
                        o = i.length; n < o; n++)
                            s[i[n]] = e.css(i[n]);
                    else
                        s = e.css();
                    t.css(s)
                }(t, i, ["letterSpacing", "fontSize", "fontFamily", "fontWeight", "textTransform"]);
                var n = i.width();
                return i.remove(),
                n
            }(i, p) + 4) !== u && (u = r,
            p.width(r),
            p.triggerHandler("resize")))
        };
        p.on("keydown keyup update blur", e),
        e()
    }
      , y = function(e, t) {
        var i, n, o, s, r = this;
        (s = e[0]).selectize = r;
        var a, l, c, p = window.getComputedStyle && window.getComputedStyle(s, null);
        if (o = (o = p ? p.getPropertyValue("direction") : s.currentStyle && s.currentStyle.direction) || e.parents("[dir]:first").attr("dir") || "",
        x.extend(r, {
            order: 0,
            settings: t,
            $input: e,
            tabIndex: e.attr("tabindex") || "",
            tagType: "select" === s.tagName.toLowerCase() ? 1 : 2,
            rtl: /rtl/i.test(o),
            eventNS: ".selectize" + ++y.count,
            highlightedValue: null,
            isOpen: !1,
            isDisabled: !1,
            isRequired: e.is("[required]"),
            isInvalid: !1,
            isLocked: !1,
            isFocused: !1,
            isInputHidden: !1,
            isSetup: !1,
            isShiftDown: !1,
            isCmdDown: !1,
            isCtrlDown: !1,
            ignoreFocus: !1,
            ignoreBlur: !1,
            ignoreHover: !1,
            hasOptions: !1,
            currentResults: null,
            lastValue: "",
            caretPos: 0,
            loading: 0,
            loadedSearches: {},
            $activeOption: null,
            $activeItems: [],
            optgroups: {},
            options: {},
            userOptions: {},
            items: [],
            renderCache: {},
            onSearchChange: null === t.loadThrottle ? r.onSearchChange : (a = r.onSearchChange,
            l = t.loadThrottle,
            function() {
                var e = this
                  , t = arguments;
                window.clearTimeout(c),
                c = window.setTimeout(function() {
                    a.apply(e, t)
                }, l)
            }
            )
        }),
        r.sifter = new u(this.options,{
            diacritics: t.diacritics
        }),
        r.settings.options) {
            for (i = 0,
            n = r.settings.options.length; i < n; i++)
                r.registerOption(r.settings.options[i]);
            delete r.settings.options
        }
        if (r.settings.optgroups) {
            for (i = 0,
            n = r.settings.optgroups.length; i < n; i++)
                r.registerOptionGroup(r.settings.optgroups[i]);
            delete r.settings.optgroups
        }
        r.settings.mode = r.settings.mode || (1 === r.settings.maxItems ? "single" : "multi"),
        "boolean" != typeof r.settings.hideSelected && (r.settings.hideSelected = "multi" === r.settings.mode),
        r.initializePlugins(r.settings.plugins),
        r.setupCallbacks(),
        r.setupTemplates(),
        r.setup()
    };
    return n.mixin(y),
    void 0 !== e ? e.mixin(y) : function(e, t) {
        t || (t = {});
        console.error("Selectize: " + e),
        t.explanation && (console.group && console.group(),
        console.error(t.explanation),
        console.group && console.groupEnd())
    }("Dependency MicroPlugin is missing", {
        explanation: 'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'
    }),
    x.extend(y.prototype, {
        setup: function() {
            var e, t, i, n, o, s, r, a, l, c, p, u, d, h, f = this, g = f.settings, v = f.eventNS, m = x(window), y = x(document), w = f.$input;
            if (r = f.settings.mode,
            a = w.attr("class") || "",
            e = x("<div>").addClass(g.wrapperClass).addClass(a).addClass(r),
            t = x("<div>").addClass(g.inputClass).addClass("items").appendTo(e),
            i = x('<input type="text" autocomplete="off" />').appendTo(t).attr("tabindex", w.is(":disabled") ? "-1" : f.tabIndex),
            s = x(g.dropdownParent || e),
            n = x("<div>").addClass(g.dropdownClass).addClass(r).hide().appendTo(s),
            o = x("<div>").addClass(g.dropdownContentClass).appendTo(n),
            (c = w.attr("id")) && (i.attr("id", c + "-selectized"),
            x("label[for='" + c + "']").attr("for", c + "-selectized")),
            f.settings.copyClassesToDropdown && n.addClass(a),
            e.css({
                width: w[0].style.width
            }),
            f.plugins.names.length && (l = "plugin-" + f.plugins.names.join(" plugin-"),
            e.addClass(l),
            n.addClass(l)),
            (null === g.maxItems || 1 < g.maxItems) && 1 === f.tagType && w.attr("multiple", "multiple"),
            f.settings.placeholder && i.attr("placeholder", g.placeholder),
            !f.settings.splitOn && f.settings.delimiter) {
                var b = f.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&");
                f.settings.splitOn = new RegExp("\\s*" + b + "+\\s*")
            }
            w.attr("autocorrect") && i.attr("autocorrect", w.attr("autocorrect")),
            w.attr("autocapitalize") && i.attr("autocapitalize", w.attr("autocapitalize")),
            f.$wrapper = e,
            f.$control = t,
            f.$control_input = i,
            f.$dropdown = n,
            f.$dropdown_content = o,
            n.on("mouseenter", "[data-selectable]", function() {
                return f.onOptionHover.apply(f, arguments)
            }),
            n.on("mousedown click", "[data-selectable]", function() {
                return f.onOptionSelect.apply(f, arguments)
            }),
            u = "mousedown",
            d = "*:not(input)",
            h = function() {
                return f.onItemSelect.apply(f, arguments)
            }
            ,
            (p = t).on(u, d, function(e) {
                for (var t = e.target; t && t.parentNode !== p[0]; )
                    t = t.parentNode;
                return e.currentTarget = t,
                h.apply(this, [e])
            }),
            I(i),
            t.on({
                mousedown: function() {
                    return f.onMouseDown.apply(f, arguments)
                },
                click: function() {
                    return f.onClick.apply(f, arguments)
                }
            }),
            i.on({
                mousedown: function(e) {
                    e.stopPropagation()
                },
                keydown: function() {
                    return f.onKeyDown.apply(f, arguments)
                },
                keyup: function() {
                    return f.onKeyUp.apply(f, arguments)
                },
                keypress: function() {
                    return f.onKeyPress.apply(f, arguments)
                },
                resize: function() {
                    f.positionDropdown.apply(f, [])
                },
                blur: function() {
                    return f.onBlur.apply(f, arguments)
                },
                focus: function() {
                    return f.ignoreBlur = !1,
                    f.onFocus.apply(f, arguments)
                },
                paste: function() {
                    return f.onPaste.apply(f, arguments)
                }
            }),
            y.on("keydown" + v, function(e) {
                f.isCmdDown = e[O ? "metaKey" : "ctrlKey"],
                f.isCtrlDown = e[O ? "altKey" : "ctrlKey"],
                f.isShiftDown = e.shiftKey
            }),
            y.on("keyup" + v, function(e) {
                e.keyCode === $ && (f.isCtrlDown = !1),
                16 === e.keyCode && (f.isShiftDown = !1),
                e.keyCode === C && (f.isCmdDown = !1)
            }),
            y.on("mousedown" + v, function(e) {
                if (f.isFocused) {
                    if (e.target === f.$dropdown[0] || e.target.parentNode === f.$dropdown[0])
                        return !1;
                    f.$control.has(e.target).length || e.target === f.$control[0] || f.blur(e.target)
                }
            }),
            m.on(["scroll" + v, "resize" + v].join(" "), function() {
                f.isOpen && f.positionDropdown.apply(f, arguments)
            }),
            m.on("mousemove" + v, function() {
                f.ignoreHover = !1
            }),
            this.revertSettings = {
                $children: w.children().detach(),
                tabindex: w.attr("tabindex")
            },
            w.attr("tabindex", -1).hide().after(f.$wrapper),
            x.isArray(g.items) && (f.setValue(g.items),
            delete g.items),
            _ && w.on("invalid" + v, function(e) {
                e.preventDefault(),
                f.isInvalid = !0,
                f.refreshState()
            }),
            f.updateOriginalInput(),
            f.refreshItems(),
            f.refreshState(),
            f.updatePlaceholder(),
            f.isSetup = !0,
            w.is(":disabled") && f.disable(),
            f.on("change", this.onChange),
            w.data("selectize", f),
            w.addClass("selectized"),
            f.trigger("initialize"),
            !0 === g.preload && f.onSearchChange("")
        },
        setupTemplates: function() {
            var i = this.settings.labelField
              , n = this.settings.optgroupLabelField
              , e = {
                optgroup: function(e) {
                    return '<div class="optgroup">' + e.html + "</div>"
                },
                optgroup_header: function(e, t) {
                    return '<div class="optgroup-header">' + t(e[n]) + "</div>"
                },
                option: function(e, t) {
                    return '<div class="option">' + t(e[i]) + "</div>"
                },
                item: function(e, t) {
                    return '<div class="item">' + t(e[i]) + "</div>"
                },
                option_create: function(e, t) {
                    return '<div class="create">Add <strong>' + t(e.input) + "</strong>&hellip;</div>"
                }
            };
            this.settings.render = x.extend({}, e, this.settings.render)
        },
        setupCallbacks: function() {
            var e, t, i = {
                initialize: "onInitialize",
                change: "onChange",
                item_add: "onItemAdd",
                item_remove: "onItemRemove",
                clear: "onClear",
                option_add: "onOptionAdd",
                option_remove: "onOptionRemove",
                option_clear: "onOptionClear",
                optgroup_add: "onOptionGroupAdd",
                optgroup_remove: "onOptionGroupRemove",
                optgroup_clear: "onOptionGroupClear",
                dropdown_open: "onDropdownOpen",
                dropdown_close: "onDropdownClose",
                type: "onType",
                load: "onLoad",
                focus: "onFocus",
                blur: "onBlur"
            };
            for (e in i)
                i.hasOwnProperty(e) && ((t = this.settings[i[e]]) && this.on(e, t))
        },
        onClick: function(e) {
            this.isFocused || (this.focus(),
            e.preventDefault())
        },
        onMouseDown: function(e) {
            var t = this
              , i = e.isDefaultPrevented();
            if (x(e.target),
            t.isFocused) {
                if (e.target !== t.$control_input[0])
                    return "single" === t.settings.mode ? t.isOpen ? t.close() : t.open() : i || t.setActiveItem(null),
                    !1
            } else
                i || window.setTimeout(function() {
                    t.focus()
                }, 0)
        },
        onChange: function() {
            this.$input.trigger("change")
        },
        onPaste: function(e) {
            var o = this;
            return o.isFull() || o.isInputHidden || o.isLocked ? void e.preventDefault() : void (o.settings.splitOn && setTimeout(function() {
                var e = o.$control_input.val();
                if (e.match(o.settings.splitOn))
                    for (var t = x.trim(e).split(o.settings.splitOn), i = 0, n = t.length; i < n; i++)
                        o.createItem(t[i])
            }, 0))
        },
        onKeyPress: function(e) {
            if (this.isLocked)
                return e && e.preventDefault();
            var t = String.fromCharCode(e.keyCode || e.which);
            return this.settings.create && "multi" === this.settings.mode && t === this.settings.delimiter ? (this.createItem(),
            e.preventDefault(),
            !1) : void 0
        },
        onKeyDown: function(e) {
            var t = (e.target,
            this.$control_input[0],
            this);
            if (!t.isLocked) {
                switch (e.keyCode) {
                case 65:
                    if (t.isCmdDown)
                        return void t.selectAll();
                    break;
                case 27:
                    return void (t.isOpen && (e.preventDefault(),
                    e.stopPropagation(),
                    t.close()));
                case 78:
                    if (!e.ctrlKey || e.altKey)
                        break;
                case 40:
                    if (!t.isOpen && t.hasOptions)
                        t.open();
                    else if (t.$activeOption) {
                        t.ignoreHover = !0;
                        var i = t.getAdjacentOption(t.$activeOption, 1);
                        i.length && t.setActiveOption(i, !0, !0)
                    }
                    return void e.preventDefault();
                case 80:
                    if (!e.ctrlKey || e.altKey)
                        break;
                case 38:
                    if (t.$activeOption) {
                        t.ignoreHover = !0;
                        var n = t.getAdjacentOption(t.$activeOption, -1);
                        n.length && t.setActiveOption(n, !0, !0)
                    }
                    return void e.preventDefault();
                case 13:
                    return void (t.isOpen && t.$activeOption && (t.onOptionSelect({
                        currentTarget: t.$activeOption
                    }),
                    e.preventDefault()));
                case 37:
                    return void t.advanceSelection(-1, e);
                case 39:
                    return void t.advanceSelection(1, e);
                case 9:
                    return t.settings.selectOnTab && t.isOpen && t.$activeOption && (t.onOptionSelect({
                        currentTarget: t.$activeOption
                    }),
                    t.isFull() || e.preventDefault()),
                    void (t.settings.create && t.createItem() && e.preventDefault());
                case 8:
                case 46:
                    return void t.deleteSelection(e)
                }
                return !t.isFull() && !t.isInputHidden || (O ? e.metaKey : e.ctrlKey) ? void 0 : void e.preventDefault()
            }
            9 !== e.keyCode && e.preventDefault()
        },
        onKeyUp: function(e) {
            var t = this;
            if (t.isLocked)
                return e && e.preventDefault();
            var i = t.$control_input.val() || "";
            t.lastValue !== i && (t.lastValue = i,
            t.onSearchChange(i),
            t.refreshOptions(),
            t.trigger("type", i))
        },
        onSearchChange: function(t) {
            var i = this
              , n = i.settings.load;
            n && (i.loadedSearches.hasOwnProperty(t) || (i.loadedSearches[t] = !0,
            i.load(function(e) {
                n.apply(i, [t, e])
            })))
        },
        onFocus: function(e) {
            var t = this
              , i = t.isFocused;
            return t.isDisabled ? (t.blur(),
            e && e.preventDefault(),
            !1) : void (t.ignoreFocus || (t.isFocused = !0,
            "focus" === t.settings.preload && t.onSearchChange(""),
            i || t.trigger("focus"),
            t.$activeItems.length || (t.showInput(),
            t.setActiveItem(null),
            t.refreshOptions(!!t.settings.openOnFocus)),
            t.refreshState()))
        },
        onBlur: function(e, t) {
            var i = this;
            if (i.isFocused && (i.isFocused = !1,
            !i.ignoreFocus)) {
                if (!i.ignoreBlur && document.activeElement === i.$dropdown_content[0])
                    return i.ignoreBlur = !0,
                    void i.onFocus(e);
                var n = function() {
                    i.close(),
                    i.setTextboxValue(""),
                    i.setActiveItem(null),
                    i.setActiveOption(null),
                    i.setCaret(i.items.length),
                    i.refreshState(),
                    t && t.focus && t.focus(),
                    i.ignoreFocus = !1,
                    i.trigger("blur")
                };
                i.ignoreFocus = !0,
                i.settings.create && i.settings.createOnBlur ? i.createItem(null, !1, n) : n()
            }
        },
        onOptionHover: function(e) {
            this.ignoreHover || this.setActiveOption(e.currentTarget, !1)
        },
        onOptionSelect: function(e) {
            var t, i, n = this;
            e.preventDefault && (e.preventDefault(),
            e.stopPropagation()),
            (i = x(e.currentTarget)).hasClass("create") ? n.createItem(null, function() {
                n.settings.closeAfterSelect && n.close()
            }) : void 0 !== (t = i.attr("data-value")) && (n.lastQuery = null,
            n.setTextboxValue(""),
            n.addItem(t),
            n.settings.closeAfterSelect ? n.close() : !n.settings.hideSelected && e.type && /mouse/.test(e.type) && n.setActiveOption(n.getOption(t)))
        },
        onItemSelect: function(e) {
            this.isLocked || "multi" === this.settings.mode && (e.preventDefault(),
            this.setActiveItem(e.currentTarget, e))
        },
        load: function(e) {
            var t = this
              , i = t.$wrapper.addClass(t.settings.loadingClass);
            t.loading++,
            e.apply(t, [function(e) {
                t.loading = Math.max(t.loading - 1, 0),
                e && e.length && (t.addOption(e),
                t.refreshOptions(t.isFocused && !t.isInputHidden)),
                t.loading || i.removeClass(t.settings.loadingClass),
                t.trigger("load", e)
            }
            ])
        },
        setTextboxValue: function(e) {
            var t = this.$control_input;
            t.val() !== e && (t.val(e).triggerHandler("update"),
            this.lastValue = e)
        },
        getValue: function() {
            return 1 === this.tagType && this.$input.attr("multiple") ? this.items : this.items.join(this.settings.delimiter)
        },
        setValue: function(e, t) {
            i(this, t ? [] : ["change"], function() {
                this.clear(t),
                this.addItems(e, t)
            })
        },
        setActiveItem: function(e, t) {
            var i, n, o, s, r, a, l, c, p = this;
            if ("single" !== p.settings.mode) {
                if (!(e = x(e)).length)
                    return x(p.$activeItems).removeClass("active"),
                    p.$activeItems = [],
                    void (p.isFocused && p.showInput());
                if ("mousedown" === (i = t && t.type.toLowerCase()) && p.isShiftDown && p.$activeItems.length) {
                    for (c = p.$control.children(".active:last"),
                    s = Array.prototype.indexOf.apply(p.$control[0].childNodes, [c[0]]),
                    (r = Array.prototype.indexOf.apply(p.$control[0].childNodes, [e[0]])) < s && (l = s,
                    s = r,
                    r = l),
                    n = s; n <= r; n++)
                        a = p.$control[0].childNodes[n],
                        -1 === p.$activeItems.indexOf(a) && (x(a).addClass("active"),
                        p.$activeItems.push(a));
                    t.preventDefault()
                } else
                    "mousedown" === i && p.isCtrlDown || "keydown" === i && this.isShiftDown ? e.hasClass("active") ? (o = p.$activeItems.indexOf(e[0]),
                    p.$activeItems.splice(o, 1),
                    e.removeClass("active")) : p.$activeItems.push(e.addClass("active")[0]) : (x(p.$activeItems).removeClass("active"),
                    p.$activeItems = [e.addClass("active")[0]]);
                p.hideInput(),
                this.isFocused || p.focus()
            }
        },
        setActiveOption: function(e, t, i) {
            var n, o, s, r, a, l = this;
            l.$activeOption && l.$activeOption.removeClass("active"),
            l.$activeOption = null,
            (e = x(e)).length && (l.$activeOption = e.addClass("active"),
            !t && c(t) || (n = l.$dropdown_content.height(),
            o = l.$activeOption.outerHeight(!0),
            t = l.$dropdown_content.scrollTop() || 0,
            a = (r = s = l.$activeOption.offset().top - l.$dropdown_content.offset().top + t) - n + o,
            n + t < s + o ? l.$dropdown_content.stop().animate({
                scrollTop: a
            }, i ? l.settings.scrollDuration : 0) : s < t && l.$dropdown_content.stop().animate({
                scrollTop: r
            }, i ? l.settings.scrollDuration : 0)))
        },
        selectAll: function() {
            var e = this;
            "single" !== e.settings.mode && (e.$activeItems = Array.prototype.slice.apply(e.$control.children(":not(input)").addClass("active")),
            e.$activeItems.length && (e.hideInput(),
            e.close()),
            e.focus())
        },
        hideInput: function() {
            this.setTextboxValue(""),
            this.$control_input.css({
                opacity: 0,
                position: "absolute",
                left: this.rtl ? 1e4 : -1e4
            }),
            this.isInputHidden = !0
        },
        showInput: function() {
            this.$control_input.css({
                opacity: 1,
                position: "relative",
                left: 0
            }),
            this.isInputHidden = !1
        },
        focus: function() {
            var e = this;
            e.isDisabled || (e.ignoreFocus = !0,
            e.$control_input[0].focus(),
            window.setTimeout(function() {
                e.ignoreFocus = !1,
                e.onFocus()
            }, 0))
        },
        blur: function(e) {
            this.$control_input[0].blur(),
            this.onBlur(null, e)
        },
        getScoreFunction: function(e) {
            return this.sifter.getScoreFunction(e, this.getSearchOptions())
        },
        getSearchOptions: function() {
            var e = this.settings
              , t = e.sortField;
            return "string" == typeof t && (t = [{
                field: t
            }]),
            {
                fields: e.searchField,
                conjunction: e.searchConjunction,
                sort: t
            }
        },
        search: function(e) {
            var t, i, n, o = this, s = o.settings, r = this.getSearchOptions();
            if (s.score && "function" != typeof (n = o.settings.score.apply(this, [e])))
                throw new Error('Selectize "score" setting must be a function that returns a function');
            if (e !== o.lastQuery ? (o.lastQuery = e,
            i = o.sifter.search(e, x.extend(r, {
                score: n
            })),
            o.currentResults = i) : i = x.extend(!0, {}, o.currentResults),
            s.hideSelected)
                for (t = i.items.length - 1; 0 <= t; t--)
                    -1 !== o.items.indexOf(k(i.items[t].id)) && i.items.splice(t, 1);
            return i
        },
        refreshOptions: function(e) {
            var t, i, n, o, s, r, a, l, c, p, u, d, h, f, g, v;
            void 0 === e && (e = !0);
            var m, y, w = this, b = x.trim(w.$control_input.val()), O = w.search(b), C = w.$dropdown_content, $ = w.$activeOption && k(w.$activeOption.attr("data-value"));
            for (o = O.items.length,
            "number" == typeof w.settings.maxOptions && (o = Math.min(o, w.settings.maxOptions)),
            s = {},
            r = [],
            t = 0; t < o; t++)
                for (a = w.options[O.items[t].id],
                l = w.render("option", a),
                c = a[w.settings.optgroupField] || "",
                i = 0,
                n = (p = x.isArray(c) ? c : [c]) && p.length; i < n; i++)
                    c = p[i],
                    w.optgroups.hasOwnProperty(c) || (c = ""),
                    s.hasOwnProperty(c) || (s[c] = document.createDocumentFragment(),
                    r.push(c)),
                    s[c].appendChild(l);
            for (this.settings.lockOptgroupOrder && r.sort(function(e, t) {
                return (w.optgroups[e].$order || 0) - (w.optgroups[t].$order || 0)
            }),
            u = document.createDocumentFragment(),
            t = 0,
            o = r.length; t < o; t++)
                c = r[t],
                w.optgroups.hasOwnProperty(c) && s[c].childNodes.length ? ((d = document.createDocumentFragment()).appendChild(w.render("optgroup_header", w.optgroups[c])),
                d.appendChild(s[c]),
                u.appendChild(w.render("optgroup", x.extend({}, w.optgroups[c], {
                    html: (m = d,
                    y = void 0,
                    y = document.createElement("div"),
                    y.appendChild(m.cloneNode(!0)),
                    y.innerHTML),
                    dom: d
                })))) : u.appendChild(s[c]);
            if (C.html(u),
            w.settings.highlight && O.query.length && O.tokens.length)
                for (C.removeHighlight(),
                t = 0,
                o = O.tokens.length; t < o; t++)
                    S(C, O.tokens[t].regex);
            if (!w.settings.hideSelected)
                for (t = 0,
                o = w.items.length; t < o; t++)
                    w.getOption(w.items[t]).addClass("selected");
            (h = w.canCreate(b)) && (C.prepend(w.render("option_create", {
                input: b
            })),
            v = x(C[0].childNodes[0])),
            w.hasOptions = 0 < O.items.length || h,
            w.hasOptions ? (0 < O.items.length ? ((g = $ && w.getOption($)) && g.length ? f = g : "single" === w.settings.mode && w.items.length && (f = w.getOption(w.items[0])),
            f && f.length || (f = v && !w.settings.addPrecedence ? w.getAdjacentOption(v, 1) : C.find("[data-selectable]:first"))) : f = v,
            w.setActiveOption(f),
            e && !w.isOpen && w.open()) : (w.setActiveOption(null),
            e && w.isOpen && w.close())
        },
        addOption: function(e) {
            var t, i, n, o = this;
            if (x.isArray(e))
                for (t = 0,
                i = e.length; t < i; t++)
                    o.addOption(e[t]);
            else
                (n = o.registerOption(e)) && (o.userOptions[n] = !0,
                o.lastQuery = null,
                o.trigger("option_add", n, e))
        },
        registerOption: function(e) {
            var t = k(e[this.settings.valueField]);
            return null != t && !this.options.hasOwnProperty(t) && (e.$order = e.$order || ++this.order,
            this.options[t] = e,
            t)
        },
        registerOptionGroup: function(e) {
            var t = k(e[this.settings.optgroupValueField]);
            return !!t && (e.$order = e.$order || ++this.order,
            this.optgroups[t] = e,
            t)
        },
        addOptionGroup: function(e, t) {
            t[this.settings.optgroupValueField] = e,
            (e = this.registerOptionGroup(t)) && this.trigger("optgroup_add", e, t)
        },
        removeOptionGroup: function(e) {
            this.optgroups.hasOwnProperty(e) && (delete this.optgroups[e],
            this.renderCache = {},
            this.trigger("optgroup_remove", e))
        },
        clearOptionGroups: function() {
            this.optgroups = {},
            this.renderCache = {},
            this.trigger("optgroup_clear")
        },
        updateOption: function(e, t) {
            var i, n, o, s, r, a, l, c = this;
            if (e = k(e),
            o = k(t[c.settings.valueField]),
            null !== e && c.options.hasOwnProperty(e)) {
                if ("string" != typeof o)
                    throw new Error("Value must be set in option data");
                l = c.options[e].$order,
                o !== e && (delete c.options[e],
                -1 !== (s = c.items.indexOf(e)) && c.items.splice(s, 1, o)),
                t.$order = t.$order || l,
                c.options[o] = t,
                r = c.renderCache.item,
                a = c.renderCache.option,
                r && (delete r[e],
                delete r[o]),
                a && (delete a[e],
                delete a[o]),
                -1 !== c.items.indexOf(o) && (i = c.getItem(e),
                n = x(c.render("item", t)),
                i.hasClass("active") && n.addClass("active"),
                i.replaceWith(n)),
                c.lastQuery = null,
                c.isOpen && c.refreshOptions(!1)
            }
        },
        removeOption: function(e, t) {
            var i = this;
            e = k(e);
            var n = i.renderCache.item
              , o = i.renderCache.option;
            n && delete n[e],
            o && delete o[e],
            delete i.userOptions[e],
            delete i.options[e],
            i.lastQuery = null,
            i.trigger("option_remove", e),
            i.removeItem(e, t)
        },
        clearOptions: function() {
            var e = this;
            e.loadedSearches = {},
            e.userOptions = {},
            e.renderCache = {},
            e.options = e.sifter.items = {},
            e.lastQuery = null,
            e.trigger("option_clear"),
            e.clear()
        },
        getOption: function(e) {
            return this.getElementWithValue(e, this.$dropdown_content.find("[data-selectable]"))
        },
        getAdjacentOption: function(e, t) {
            var i = this.$dropdown.find("[data-selectable]")
              , n = i.index(e) + t;
            return 0 <= n && n < i.length ? i.eq(n) : x()
        },
        getElementWithValue: function(e, t) {
            if (null != (e = k(e)))
                for (var i = 0, n = t.length; i < n; i++)
                    if (t[i].getAttribute("data-value") === e)
                        return x(t[i]);
            return x()
        },
        getItem: function(e) {
            return this.getElementWithValue(e, this.$control.children())
        },
        addItems: function(e, t) {
            for (var i = x.isArray(e) ? e : [e], n = 0, o = i.length; n < o; n++)
                this.isPending = n < o - 1,
                this.addItem(i[n], t)
        },
        addItem: function(a, l) {
            i(this, l ? [] : ["change"], function() {
                var e, t, i, n, o, s = this, r = s.settings.mode;
                return a = k(a),
                -1 !== s.items.indexOf(a) ? void ("single" === r && s.close()) : void (s.options.hasOwnProperty(a) && ("single" === r && s.clear(l),
                "multi" === r && s.isFull() || (e = x(s.render("item", s.options[a])),
                o = s.isFull(),
                s.items.splice(s.caretPos, 0, a),
                s.insertAtCaret(e),
                (!s.isPending || !o && s.isFull()) && s.refreshState(),
                s.isSetup && (i = s.$dropdown_content.find("[data-selectable]"),
                s.isPending || (t = s.getOption(a),
                n = s.getAdjacentOption(t, 1).attr("data-value"),
                s.refreshOptions(s.isFocused && "single" !== r),
                n && s.setActiveOption(s.getOption(n))),
                !i.length || s.isFull() ? s.close() : s.positionDropdown(),
                s.updatePlaceholder(),
                s.trigger("item_add", a, e),
                s.updateOriginalInput({
                    silent: l
                })))))
            })
        },
        removeItem: function(e, t) {
            var i, n, o, s = this;
            i = e instanceof x ? e : s.getItem(e),
            e = k(i.attr("data-value")),
            -1 !== (n = s.items.indexOf(e)) && (i.remove(),
            i.hasClass("active") && (o = s.$activeItems.indexOf(i[0]),
            s.$activeItems.splice(o, 1)),
            s.items.splice(n, 1),
            s.lastQuery = null,
            !s.settings.persist && s.userOptions.hasOwnProperty(e) && s.removeOption(e, t),
            n < s.caretPos && s.setCaret(s.caretPos - 1),
            s.refreshState(),
            s.updatePlaceholder(),
            s.updateOriginalInput({
                silent: t
            }),
            s.positionDropdown(),
            s.trigger("item_remove", e, i))
        },
        createItem: function(e, i) {
            var n = this
              , o = n.caretPos;
            e = e || x.trim(n.$control_input.val() || "");
            var s = arguments[arguments.length - 1];
            if ("function" != typeof s && (s = function() {}
            ),
            "boolean" != typeof i && (i = !0),
            !n.canCreate(e))
                return s(),
                !1;
            n.lock();
            var t, r, a = "function" == typeof n.settings.create ? this.settings.create : function(e) {
                var t = {};
                return t[n.settings.labelField] = e,
                t[n.settings.valueField] = e,
                t
            }
            , l = (r = !(t = function(e) {
                if (n.unlock(),
                !e || "object" != typeof e)
                    return s();
                var t = k(e[n.settings.valueField]);
                return "string" != typeof t ? s() : (n.setTextboxValue(""),
                n.addOption(e),
                n.setCaret(o),
                n.addItem(t),
                n.refreshOptions(i && "single" !== n.settings.mode),
                void s(e))
            }
            ),
            function() {
                r || (r = !0,
                t.apply(this, arguments))
            }
            ), c = a.apply(this, [e, l]);
            return void 0 !== c && l(c),
            !0
        },
        refreshItems: function() {
            this.lastQuery = null,
            this.isSetup && this.addItem(this.items),
            this.refreshState(),
            this.updateOriginalInput()
        },
        refreshState: function() {
            this.refreshValidityState(),
            this.refreshClasses()
        },
        refreshValidityState: function() {
            if (!this.isRequired)
                return !1;
            var e = !this.items.length;
            this.isInvalid = e,
            this.$control_input.prop("required", e),
            this.$input.prop("required", !e)
        },
        refreshClasses: function() {
            var e = this
              , t = e.isFull()
              , i = e.isLocked;
            e.$wrapper.toggleClass("rtl", e.rtl),
            e.$control.toggleClass("focus", e.isFocused).toggleClass("disabled", e.isDisabled).toggleClass("required", e.isRequired).toggleClass("invalid", e.isInvalid).toggleClass("locked", i).toggleClass("full", t).toggleClass("not-full", !t).toggleClass("input-active", e.isFocused && !e.isInputHidden).toggleClass("dropdown-active", e.isOpen).toggleClass("has-options", !x.isEmptyObject(e.options)).toggleClass("has-items", 0 < e.items.length),
            e.$control_input.data("grow", !t && !i)
        },
        isFull: function() {
            return null !== this.settings.maxItems && this.items.length >= this.settings.maxItems
        },
        updateOriginalInput: function(e) {
            var t, i, n, o, s = this;
            if (e = e || {},
            1 === s.tagType) {
                for (n = [],
                t = 0,
                i = s.items.length; t < i; t++)
                    o = s.options[s.items[t]][s.settings.labelField] || "",
                    n.push('<option value="' + a(s.items[t]) + '" selected="selected">' + a(o) + "</option>");
                n.length || this.$input.attr("multiple") || n.push('<option value="" selected="selected"></option>'),
                s.$input.html(n.join(""))
            } else
                s.$input.val(s.getValue()),
                s.$input.attr("value", s.$input.val());
            s.isSetup && (e.silent || s.trigger("change", s.$input.val()))
        },
        updatePlaceholder: function() {
            if (this.settings.placeholder) {
                var e = this.$control_input;
                this.items.length ? e.removeAttr("placeholder") : e.attr("placeholder", this.settings.placeholder),
                e.triggerHandler("update", {
                    force: !0
                })
            }
        },
        open: function() {
            var e = this;
            e.isLocked || e.isOpen || "multi" === e.settings.mode && e.isFull() || (e.focus(),
            e.isOpen = !0,
            e.refreshState(),
            e.$dropdown.css({
                visibility: "hidden",
                display: "block"
            }),
            e.positionDropdown(),
            e.$dropdown.css({
                visibility: "visible"
            }),
            e.trigger("dropdown_open", e.$dropdown))
        },
        close: function() {
            var e = this
              , t = e.isOpen;
            "single" === e.settings.mode && e.items.length && (e.hideInput(),
            e.$control_input.blur()),
            e.isOpen = !1,
            e.$dropdown.hide(),
            e.setActiveOption(null),
            e.refreshState(),
            t && e.trigger("dropdown_close", e.$dropdown)
        },
        positionDropdown: function() {
            var e = this.$control
              , t = "body" === this.settings.dropdownParent ? e.offset() : e.position();
            t.top += e.outerHeight(!0),
            this.$dropdown.css({
                width: e.outerWidth(),
                top: t.top,
                left: t.left
            })
        },
        clear: function(e) {
            var t = this;
            t.items.length && (t.$control.children(":not(input)").remove(),
            t.items = [],
            t.lastQuery = null,
            t.setCaret(0),
            t.setActiveItem(null),
            t.updatePlaceholder(),
            t.updateOriginalInput({
                silent: e
            }),
            t.refreshState(),
            t.showInput(),
            t.trigger("clear"))
        },
        insertAtCaret: function(e) {
            var t = Math.min(this.caretPos, this.items.length);
            0 === t ? this.$control.prepend(e) : x(this.$control[0].childNodes[t]).before(e),
            this.setCaret(t + 1)
        },
        deleteSelection: function(e) {
            var t, i, n, o, s, r, a, l, c, p = this;
            if (n = e && 8 === e.keyCode ? -1 : 1,
            o = d(p.$control_input[0]),
            p.$activeOption && !p.settings.hideSelected && (a = p.getAdjacentOption(p.$activeOption, -1).attr("data-value")),
            s = [],
            p.$activeItems.length) {
                for (c = p.$control.children(".active:" + (0 < n ? "last" : "first")),
                r = p.$control.children(":not(input)").index(c),
                0 < n && r++,
                t = 0,
                i = p.$activeItems.length; t < i; t++)
                    s.push(x(p.$activeItems[t]).attr("data-value"));
                e && (e.preventDefault(),
                e.stopPropagation())
            } else
                (p.isFocused || "single" === p.settings.mode) && p.items.length && (n < 0 && 0 === o.start && 0 === o.length ? s.push(p.items[p.caretPos - 1]) : 0 < n && o.start === p.$control_input.val().length && s.push(p.items[p.caretPos]));
            if (!s.length || "function" == typeof p.settings.onDelete && !1 === p.settings.onDelete.apply(p, [s]))
                return !1;
            for (void 0 !== r && p.setCaret(r); s.length; )
                p.removeItem(s.pop());
            return p.showInput(),
            p.positionDropdown(),
            p.refreshOptions(!0),
            a && ((l = p.getOption(a)).length && p.setActiveOption(l)),
            !0
        },
        advanceSelection: function(e, t) {
            var i, n, o, s, r, a = this;
            0 !== e && (a.rtl && (e *= -1),
            i = 0 < e ? "last" : "first",
            n = d(a.$control_input[0]),
            a.isFocused && !a.isInputHidden ? (s = a.$control_input.val().length,
            (e < 0 ? 0 === n.start && 0 === n.length : n.start === s) && !s && a.advanceCaret(e, t)) : (r = a.$control.children(".active:" + i)).length && (o = a.$control.children(":not(input)").index(r),
            a.setActiveItem(null),
            a.setCaret(0 < e ? o + 1 : o)))
        },
        advanceCaret: function(e, t) {
            var i, n, o = this;
            0 !== e && (i = 0 < e ? "next" : "prev",
            o.isShiftDown ? (n = o.$control_input[i]()).length && (o.hideInput(),
            o.setActiveItem(n),
            t && t.preventDefault()) : o.setCaret(o.caretPos + e))
        },
        setCaret: function(e) {
            var t, i, n, o, s = this;
            if (e = "single" === s.settings.mode ? s.items.length : Math.max(0, Math.min(s.items.length, e)),
            !s.isPending)
                for (t = 0,
                i = (n = s.$control.children(":not(input)")).length; t < i; t++)
                    o = x(n[t]).detach(),
                    t < e ? s.$control_input.before(o) : s.$control.append(o);
            s.caretPos = e
        },
        lock: function() {
            this.close(),
            this.isLocked = !0,
            this.refreshState()
        },
        unlock: function() {
            this.isLocked = !1,
            this.refreshState()
        },
        disable: function() {
            this.$input.prop("disabled", !0),
            this.$control_input.prop("disabled", !0).prop("tabindex", -1),
            this.isDisabled = !0,
            this.lock()
        },
        enable: function() {
            var e = this;
            e.$input.prop("disabled", !1),
            e.$control_input.prop("disabled", !1).prop("tabindex", e.tabIndex),
            e.isDisabled = !1,
            e.unlock()
        },
        destroy: function() {
            var e = this
              , t = e.eventNS
              , i = e.revertSettings;
            e.trigger("destroy"),
            e.off(),
            e.$wrapper.remove(),
            e.$dropdown.remove(),
            e.$input.html("").append(i.$children).removeAttr("tabindex").removeClass("selectized").attr({
                tabindex: i.tabindex
            }).show(),
            e.$control_input.removeData("grow"),
            e.$input.removeData("selectize"),
            x(window).off(t),
            x(document).off(t),
            x(document.body).off(t),
            delete e.$input[0].selectize
        },
        render: function(e, t) {
            var i, n, o = "", s = !1, r = this;
            return "option" !== e && "item" !== e || (s = !!(i = k(t[r.settings.valueField]))),
            s && (c(r.renderCache[e]) || (r.renderCache[e] = {}),
            r.renderCache[e].hasOwnProperty(i)) ? r.renderCache[e][i] : (o = x(r.settings.render[e].apply(this, [t, a])),
            "option" === e || "option_create" === e ? o.attr("data-selectable", "") : "optgroup" === e && (n = t[r.settings.optgroupValueField] || "",
            o.attr("data-group", n)),
            "option" !== e && "item" !== e || o.attr("data-value", i || ""),
            s && (r.renderCache[e][i] = o[0]),
            o[0])
        },
        clearCache: function(e) {
            void 0 === e ? this.renderCache = {} : delete this.renderCache[e]
        },
        canCreate: function(e) {
            if (!this.settings.create)
                return !1;
            var t = this.settings.createFilter;
            return e.length && ("function" != typeof t || t.apply(this, [e])) && ("string" != typeof t || new RegExp(t).test(e)) && (!(t instanceof RegExp) || t.test(e))
        }
    }),
    y.count = 0,
    y.defaults = {
        options: [],
        optgroups: [],
        plugins: [],
        delimiter: ",",
        splitOn: null,
        persist: !0,
        diacritics: !0,
        create: !1,
        createOnBlur: !1,
        createFilter: null,
        highlight: !0,
        openOnFocus: !0,
        maxOptions: 1e3,
        maxItems: null,
        hideSelected: null,
        addPrecedence: !1,
        selectOnTab: !1,
        preload: !1,
        allowEmptyOption: !1,
        closeAfterSelect: !1,
        scrollDuration: 60,
        loadThrottle: 300,
        loadingClass: "loading",
        dataAttr: "data-data",
        optgroupField: "optgroup",
        valueField: "value",
        labelField: "text",
        optgroupLabelField: "label",
        optgroupValueField: "value",
        lockOptgroupOrder: !1,
        sortField: "$order",
        searchField: ["text"],
        searchConjunction: "and",
        mode: null,
        wrapperClass: "selectize-control",
        inputClass: "selectize-input",
        dropdownClass: "selectize-dropdown",
        dropdownContentClass: "selectize-dropdown-content",
        dropdownParent: null,
        copyClassesToDropdown: !0,
        render: {}
    },
    x.fn.selectize = function(o) {
        var s = x.fn.selectize.defaults
          , u = x.extend({}, s, o)
          , d = u.dataAttr
          , h = u.labelField
          , f = u.valueField
          , g = u.optgroupField
          , v = u.optgroupLabelField
          , m = u.optgroupValueField;
        return this.each(function() {
            if (!this.selectize) {
                var e = x(this)
                  , t = this.tagName.toLowerCase()
                  , i = e.attr("placeholder") || e.attr("data-placeholder");
                i || u.allowEmptyOption || (i = e.children('option[value=""]').text());
                var n = {
                    placeholder: i,
                    options: [],
                    optgroups: [],
                    items: []
                };
                "select" === t ? function(e, r) {
                    var t, i, n, o, s = r.options, a = {}, l = function(e) {
                        var t = d && e.attr(d);
                        return "string" == typeof t && t.length ? JSON.parse(t) : null
                    }, c = function(e, t) {
                        e = x(e);
                        var i = k(e.val());
                        if (i || u.allowEmptyOption)
                            if (a.hasOwnProperty(i)) {
                                if (t) {
                                    var n = a[i][g];
                                    n ? x.isArray(n) ? n.push(t) : a[i][g] = [n, t] : a[i][g] = t
                                }
                            } else {
                                var o = l(e) || {};
                                o[h] = o[h] || e.text(),
                                o[f] = o[f] || i,
                                o[g] = o[g] || t,
                                a[i] = o,
                                s.push(o),
                                e.is(":selected") && r.items.push(i)
                            }
                    }, p = function(e) {
                        var t, i, n, o, s;
                        for ((n = (e = x(e)).attr("label")) && ((o = l(e) || {})[v] = n,
                        o[m] = n,
                        r.optgroups.push(o)),
                        t = 0,
                        i = (s = x("option", e)).length; t < i; t++)
                            c(s[t], n)
                    };
                    for (r.maxItems = e.attr("multiple") ? null : 1,
                    t = 0,
                    i = (o = e.children()).length; t < i; t++)
                        "optgroup" === (n = o[t].tagName.toLowerCase()) ? p(o[t]) : "option" === n && c(o[t])
                }(e, n) : function(e, t) {
                    var i, n, o, s, r = e.attr(d);
                    if (r)
                        for (t.options = JSON.parse(r),
                        i = 0,
                        n = t.options.length; i < n; i++)
                            t.items.push(t.options[i][f]);
                    else {
                        var a = x.trim(e.val() || "");
                        if (!u.allowEmptyOption && !a.length)
                            return;
                        for (i = 0,
                        n = (o = a.split(u.delimiter)).length; i < n; i++)
                            (s = {})[h] = o[i],
                            s[f] = o[i],
                            t.options.push(s);
                        t.items = o
                    }
                }(e, n),
                new y(e,x.extend(!0, {}, s, n, o))
            }
        })
    }
    ,
    x.fn.selectize.defaults = y.defaults,
    x.fn.selectize.support = {
        validity: _
    },
    y.define("drag_drop", function(e) {
        if (!x.fn.sortable)
            throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');
        if ("multi" === this.settings.mode) {
            var n = this;
            n.lock = (o = n.lock,
            function() {
                var e = n.$control.data("sortable");
                return e && e.disable(),
                o.apply(n, arguments)
            }
            ),
            n.unlock = (i = n.unlock,
            function() {
                var e = n.$control.data("sortable");
                return e && e.enable(),
                i.apply(n, arguments)
            }
            ),
            n.setup = (t = n.setup,
            function() {
                t.apply(this, arguments);
                var i = n.$control.sortable({
                    items: "[data-value]",
                    forcePlaceholderSize: !0,
                    disabled: n.isLocked,
                    start: function(e, t) {
                        t.placeholder.css("width", t.helper.css("width")),
                        i.css({
                            overflow: "visible"
                        })
                    },
                    stop: function() {
                        i.css({
                            overflow: "hidden"
                        });
                        var e = n.$activeItems ? n.$activeItems.slice() : null
                          , t = [];
                        i.children("[data-value]").each(function() {
                            t.push(x(this).attr("data-value"))
                        }),
                        n.setValue(t),
                        n.setActiveItem(e)
                    }
                })
            }
            )
        }
        var t, i, o
    }),
    y.define("dropdown_header", function(e) {
        var t, i = this;
        e = x.extend({
            title: "Untitled",
            headerClass: "selectize-dropdown-header",
            titleRowClass: "selectize-dropdown-header-title",
            labelClass: "selectize-dropdown-header-label",
            closeClass: "selectize-dropdown-header-close",
            html: function(e) {
                return '<div class="' + e.headerClass + '"><div class="' + e.titleRowClass + '"><span class="' + e.labelClass + '">' + e.title + '</span><a href="javascript:void(0)" class="' + e.closeClass + '">&times;</a></div></div>'
            }
        }, e),
        i.setup = (t = i.setup,
        function() {
            t.apply(i, arguments),
            i.$dropdown_header = x(e.html(e)),
            i.$dropdown.prepend(i.$dropdown_header)
        }
        )
    }),
    y.define("optgroup_columns", function(a) {
        var s, l = this;
        a = x.extend({
            equalizeWidth: !0,
            equalizeHeight: !0
        }, a),
        this.getAdjacentOption = function(e, t) {
            var i = e.closest("[data-group]").find("[data-selectable]")
              , n = i.index(e) + t;
            return 0 <= n && n < i.length ? i.eq(n) : x()
        }
        ,
        this.onKeyDown = (s = l.onKeyDown,
        function(e) {
            var t, i, n, o;
            return !this.isOpen || 37 !== e.keyCode && 39 !== e.keyCode ? s.apply(this, arguments) : (l.ignoreHover = !0,
            t = (o = this.$activeOption.closest("[data-group]")).find("[data-selectable]").index(this.$activeOption),
            void ((i = (n = (o = 37 === e.keyCode ? o.prev("[data-group]") : o.next("[data-group]")).find("[data-selectable]")).eq(Math.min(n.length - 1, t))).length && this.setActiveOption(i)))
        }
        );
        var c = function() {
            var e, t = c.width, i = document;
            return void 0 === t && ((e = i.createElement("div")).innerHTML = '<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',
            e = e.firstChild,
            i.body.appendChild(e),
            t = c.width = e.offsetWidth - e.clientWidth,
            i.body.removeChild(e)),
            t
        }
          , e = function() {
            var e, t, i, n, o, s, r;
            if ((t = (r = x("[data-group]", l.$dropdown_content)).length) && l.$dropdown_content.width()) {
                if (a.equalizeHeight) {
                    for (e = i = 0; e < t; e++)
                        i = Math.max(i, r.eq(e).height());
                    r.css({
                        height: i
                    })
                }
                a.equalizeWidth && (s = l.$dropdown_content.innerWidth() - c(),
                n = Math.round(s / t),
                r.css({
                    width: n
                }),
                1 < t && (o = s - n * (t - 1),
                r.eq(t - 1).css({
                    width: o
                })))
            }
        };
        (a.equalizeHeight || a.equalizeWidth) && (t.after(this, "positionDropdown", e),
        t.after(this, "refreshOptions", e))
    }),
    y.define("remove_button", function(e) {
        e = x.extend({
            label: "&times;",
            title: "Remove",
            className: "remove",
            append: !0
        }, e);
        var s, t, i, n, r;
        return "single" === this.settings.mode ? void function(i, n) {
            n.className = "remove-single";
            var o, s = i, r = '<a href="javascript:void(0)" class="' + n.className + '" tabindex="-1" title="' + a(n.title) + '">' + n.label + "</a>";
            i.setup = (o = s.setup,
            function() {
                if (n.append) {
                    var e = x(s.$input.context).attr("id")
                      , t = (x("#" + e),
                    s.settings.render.item);
                    s.settings.render.item = function(e) {
                        return t.apply(i, arguments) + r
                    }
                }
                o.apply(i, arguments),
                i.$control.on("click", "." + n.className, function(e) {
                    e.preventDefault(),
                    s.isLocked || s.clear()
                })
            }
            )
        }(this, e) : (n = s = this,
        r = '<a href="javascript:void(0)" class="' + (t = e).className + '" tabindex="-1" title="' + a(t.title) + '">' + t.label + "</a>",
        void (s.setup = (i = n.setup,
        function() {
            if (t.append) {
                var o = n.settings.render.item;
                n.settings.render.item = function(e) {
                    return t = o.apply(s, arguments),
                    i = r,
                    n = t.search(/(<\/[^>]+>\s*)$/),
                    t.substring(0, n) + i + t.substring(n);
                    var t, i, n
                }
            }
            i.apply(s, arguments),
            s.$control.on("click", "." + t.className, function(e) {
                if (e.preventDefault(),
                !n.isLocked) {
                    var t = x(e.currentTarget).parent();
                    n.setActiveItem(t),
                    n.deleteSelection() && n.setCaret(n.items.length)
                }
            })
        }
        )))
    }),
    y.define("restore_on_backspace", function(n) {
        var o, e = this;
        n.text = n.text || function(e) {
            return e[this.settings.labelField]
        }
        ,
        this.onKeyDown = (o = e.onKeyDown,
        function(e) {
            var t, i;
            return 8 === e.keyCode && "" === this.$control_input.val() && !this.$activeItems.length && 0 <= (t = this.caretPos - 1) && t < this.items.length ? (i = this.options[this.items[t]],
            this.deleteSelection(e) && (this.setTextboxValue(n.text.apply(this, [i])),
            this.refreshOptions(!0)),
            void e.preventDefault()) : o.apply(this, arguments)
        }
        )
    }),
    y
}),
function(s, e, t, i) {
    "use strict";
    var o = ".cfy"
      , n = {
        init: function(e) {
            this.stopPlugin = !1,
            this.options = s.extend({}, s.confy.options, e),
            this.initEvents(),
            this._populate()
        },
        _populate: function() {
            var i, n, o = this;
            o.options.items.each(function(e, t) {
                switch (t = s(t),
                (i = {
                    type: t.data("type"),
                    value: t.data("value"),
                    option: t.data("option")
                }).type) {
                case "radio":
                    n = o._getValueFromString(i.option),
                    i.value === n && t.addClass("cfy-active");
                    break;
                case "textfield":
                    n = o._getValueFromString(i.option),
                    t.val(n),
                    t.data("value", n);
                    break;
                case "checkbox":
                    (n = o._getValueFromString(i.option)) ? (t.addClass("cfy-on"),
                    t.data("value", "true")) : (t.removeClass("cfy-on"),
                    t.data("value", "false"));
                    break;
                case "selectbox":
                    n = o._getValueFromString(i.option),
                    t.data("value", n),
                    t.find('option[data-value="' + n + '"]').prop({
                        selected: !0
                    })
                }
            }),
            o.options.dependencies.call(o, o.options.settings)
        },
        _getValueFromString: function(e) {
            var t, i = e.split("."), n = this.options.settings[i[0]];
            for (t = 1; t < i.length; t++)
                n = n[i[t]];
            return n
        },
        _setValueFromString: function(e, t) {
            var i, n, o = e.split("."), s = o.length;
            if (1 === s)
                this.options.settings[o[0]] = t;
            else {
                for (n = this.options.settings[o[0]],
                i = 1; i < s - 1; i++)
                    n = n[o[i]];
                n[o[s - 1]] = t
            }
        },
        _change: function(e) {
            var t = this
              , i = {
                type: e.data("type"),
                value: e.data("value"),
                option: e.data("option")
            };
            if (!e.hasClass("cfy-active")) {
                switch (t._reset(),
                i.type) {
                case "radio":
                    t._setValueFromString(i.option, i.value);
                    break;
                case "textfield":
                    i.value = parseInt(i.value, 10),
                    i.value = i.value % 1 == 0 ? i.value : 0,
                    e.data("value", i.value),
                    t._setValueFromString(i.option, i.value);
                    break;
                case "checkbox":
                    i.value = "true" != i.value,
                    t._setValueFromString(i.option, i.value);
                    break;
                case "selectbox":
                    t._setValueFromString(i.option, i.value)
                }
                setTimeout(function() {
                    t.options.callback.call(t, t.options.settings),
                    t._populate()
                }, 200)
            }
        },
        _reset: function() {
            var n, o = this;
            o.options.items.each(function(e, t) {
                var i = {
                    type: (t = s(t)).data("type"),
                    value: t.data("value"),
                    option: t.data("option")
                };
                switch (i.type) {
                case "radio":
                    n = o._getValueFromString(i.option),
                    i.value === n && t.removeClass("cfy-active");
                    break;
                case "textfield":
                    t.data("value", "");
                    break;
                case "checkbox":
                    (n = o._getValueFromString(i.option)) && (t.removeClass("cfy-on"),
                    t.data("value", ""));
                    break;
                case "selectbox":
                    t.data("value", "")
                }
            })
        },
        initEvents: function() {
            var n = this;
            n.options.items.filter('[data-type="radio"], [data-type="checkbox"]').on("click" + o, function(e) {
                n.stopPlugin || (n._change(s(this)),
                e.preventDefault())
            }),
            n.options.items.filter('[data-type="textfield"]').on("keypress" + o, function(e) {
                if (!n.stopPlugin) {
                    var t = s(this);
                    13 === (e.keyCode ? e.keyCode : e.which) && (t.data("value", t.val()),
                    n._change(t))
                }
            }),
            n.options.items.filter('[data-type="selectbox"]').on("change" + o, function(e) {
                if (!n.stopPlugin) {
                    var t = s(this)
                      , i = t.find("option:selected").data("value");
                    t.data("value", i),
                    n._change(t)
                }
            }),
            s(".cfy-item-add").on("click", function() {
                var e = s(this).prev()
                  , t = e.find("option:selected").next()
                  , i = t.length ? t.val() : e.find("option").first().val();
                e.val(i).prop("selected", !0).change()
            }),
            s(".cfy-item-sub").on("click", function() {
                var e = s(this).next()
                  , t = e.find("option:selected").prev()
                  , i = t.length ? t.val() : e.find("option").last().val();
                e.val(i).prop("selected", !0).change()
            })
        }
    };
    s.confy = Object.create(n),
    s.confy.options = {
        items: "",
        callback: function(e) {},
        dependencies: function(e) {},
        settings: null
    }
}(jQuery, window, document),
function(i, e, t, n) {
    "use strict";
    Array.prototype.indexOf || (Array.prototype.indexOf = function(e, t) {
        for (var i = t || 0, n = this.length; i < n; i++)
            if (this[i] === e)
                return i;
        return -1
    }
    );
    var o = i("#js-grid-juicy-projects")
      , s = i("#js-grid-juicy-projects-tool");
    o.one("initComplete.cbp", function() {
        i.confy.init({
            items: s.find(".cfy-item"),
            callback: function(e) {
                o.cubeportfolio("destroy", function() {
                    o.cubeportfolio("init", e)
                })
            },
            dependencies: function(e) {
                "default" == e.displayType ? s.find('input[data-option="displayTypeSpeed"]').hide() : s.find('input[data-option="displayTypeSpeed"]').show()
            },
            settings: i.extend({}, i.data(t.getElementById("js-grid-juicy-projects"), "cubeportfolio").options)
        })
    });
    var r = i("#js-grid-lightbox-gallery")
      , a = i("#js-grid-lightbox-gallery-tool");
    r.one("initComplete.cbp", function() {
        i.confy.init({
            items: a.find(".cfy-item"),
            callback: function(e) {
                r.cubeportfolio("destroy", function() {
                    r.cubeportfolio("init", e)
                })
            },
            dependencies: function(e) {
                "default" == e.displayType ? a.find('input[data-option="displayTypeSpeed"]').hide() : a.find('input[data-option="displayTypeSpeed"]').show()
            },
            settings: i.extend({}, i.data(t.getElementById("js-grid-lightbox-gallery"), "cubeportfolio").options)
        })
    }),
    i("#js-usage-examples").cubeportfolio({
        displayType: "default",
        lightboxDelegate: "",
        singlePageDelegate: "",
        singlePageInlineDelegate: "",
        gridAdjustment: "responsive",
        caption: "zoom",
        mediaQueries: [{
            width: 1500,
            cols: 3
        }, {
            width: 1100,
            cols: 3
        }, {
            width: 800,
            cols: 3
        }, {
            width: 480,
            cols: 2,
            options: {
                gapHorizontal: 25,
                gapVertical: 15
            }
        }],
        gapHorizontal: 35,
        gapVertical: 50
    }),
    i('a[href*="#"]').on("click", function(e) {
        if (!1 === /\//gi.test(this.hash)) {
            var t = i(this.hash);
            t.length && (e.preventDefault(),
            i("html,body").animate({
                scrollTop: t.offset().top
            }, 500))
        }
    }),
    i("#js-custom-masonry").cubeportfolio({
        filters: "#js-custom-masonry-filter",
        animationType: "quicksand",
        gapHorizontal: 7,
        gapVertical: 7
    }),
    i("#js-custom-mosaic").cubeportfolio({
        filters: "#js-custom-mosaic-filter",
        animationType: "quicksand",
        gapHorizontal: 5,
        gapVertical: 5,
        layoutMode: "mosaic"
    }),
    i("#js-custom-crazy").cubeportfolio({
        filters: "#js-custom-crazy-filter",
        animationType: "quicksand",
        layoutMode: "mosaic",
        gridAdjustment: "default",
        gapHorizontal: 5,
        gapVertical: 5
    });
    var l = i(".js-selectize");
    l.length && l.selectize(),
    localStorage && localStorage.pcode && i("#id-purchasecode").attr("value", localStorage.pcode);
    var c = i("#js-download-build")
      , p = i("#js-download-build-error")
      , u = !1;
    i("#js-submit-build").on("click", function(e) {
        if (!u) {
            u = !0,
            c.attr("class", "svelte-download svelte-download--loading"),
            p.text("");
            var t = {
                options: {
                    caption: i("#id-caption").val(),
                    filter: i("#id-filter").val(),
                    animation: i("#id-animation").val(),
                    displayType: i("#id-displayType").val(),
                    loadMore: i("#id-loadMore").val(),
                    layout: i("#id-layout").val(),
                    popup: i("#id-popup")[0].checked,
                    slider: i("#id-slider")[0].checked,
                    search: i("#id-search")[0].checked,
                    lazyLoad: i("#id-lazyLoad")[0].checked,
                    social: i("#id-social")[0].checked
                },
                purchasecode: i("#id-purchasecode").val()
            };
            localStorage && t.purchasecode && (localStorage.pcode = t.purchasecode),
            i.ajax({
                method: "POST",
                url: "http://svelte.scriptpie.com/svelte",
                data: JSON.stringify(t)
            }).done(function(e) {
                c.find("a").attr("href", "http://svelte.scriptpie.com" + e),
                c.attr("class", "svelte-download svelte-download--done")
            }).fail(function(e) {
                c.attr("class", "svelte-download"),
                '["bad purchasecode"]' === e.responseText ? p.text("--- Your `Purchase Code` field is empty!") : '["bad purchasecode 2"]' === e.responseText ? p.text("--- Your `Purchase Code` is invalid!") : '["support expired"]' === e.responseText ? p[0].innerHTML = '--- Your support period is expired. Renew it from <a href="https://codecanyon.net/item/cube-portfolio-responsive-jquery-grid-plugin/6372959" target="_blank">my plugin page</a>!' : p[0].innerHTML = '--- 101 error - Please contact me from <a href="https://codecanyon.net/item/cube-portfolio-responsive-jquery-grid-plugin/6372959/support" target="_blank">my support page</a> to resolve this issue!'
            }).always(function() {
                u = !1
            })
        }
    })
}(jQuery, window, document),
function(e, t, i, n) {
    "use strict";
    t._ulmo = t._ulmo || [];
    var o = !1;
    t._ulmo.push(["action", "jiu9dd25", function() {
        drift.on("ready", function(e, t) {
            o || (o = !0,
            e.showWelcomeMessage({
                message: "Hi there, do you have any questions about Cube Portfolio's features or functionality?"
            }))
        })
    }
    ]),
    t._ulmo.push(["action", "jiu9fklg", function() {
        drift.on("ready", function(e, t) {
            o || (o = !0,
            e.showWelcomeMessage({
                message: "Hi there, do you have any questions about how Cube Portfolio works?"
            }))
        })
    }
    ])
}(jQuery, window, document);
